\input texinfo

@setfilename guile-xosd.info
@documentencoding UTF-8
@settitle Guile-XOSD Reference Manual

@include version.texi

@copying
Copyright @copyright{} 2016-2026 Alex Kost

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled ``GNU Free
Documentation License.''
@end copying

@dircategory The Algorithmic Language Scheme
@direntry
* Guile-XOSD: (guile-xosd).     Guile bindings for libxosd.
@end direntry

@titlepage
@title Guile-XOSD Reference Manual
@subtitle for Guile-XOSD @value{VERSION}
@author Alex Kost

@page
@vskip 0pt plus 1filll

@insertcopying
@end titlepage

@contents

@c ----------------------------------------------------------------
@node Top
@top Guile-XOSD

This document describes Guile-XOSD version @value{VERSION}, Guile
bindings for @code{libxosd} library.

@menu
* Introduction::
* Installation::
* API Reference::
* Example::
* Hacking::

Appendices

* GNU Free Documentation License::  The license of this manual.

@end menu

@node Introduction
@chapter Introduction

Guile-XOSD provides the complete set of Guile bindings for
@code{libxosd}, the @uref{http://sourceforge.net/projects/libxosd/,
XOSD} library.

This manual describes only the Guile procedures (@pxref{API
Reference}).  For the documentation on the XOSD itself, see its man
pages and the full and descriptive XOSD manual, which can be found at
@uref{http://ldots.org/xosd-guide/xosd_guide-onepage.html}.

@node Installation
@chapter Installation

Guile-XOSD depends on the following packages:

@itemize
@item @uref{http://gnu.org/software/guile/, GNU Guile}, 2.0.2 or later;
@item @uref{http://sourceforge.net/projects/libxosd/, libxosd}, 2.2 or later.
@end itemize

The latest release of Guile-XOSD can be found at
@uref{https://github.com/alezost/guile-xosd/releases}.  It can be
installed with the usual sequence of commands of the GNU Build System
(@code{./configure && make && make install}).  For more details on the
installation process, see @file{INSTALL} file.

If you want to build Guile-XOSD from a git checkout, you can do it
with the following additional steps (before running
@code{./configure}):

@example
$ git clone https://github.com/alezost/guile-xosd.git
$ cd guile-xosd
$ ./autogen.sh
@end example

@strong{Important:} Guile modules are installed under the configured
@code{prefix}.  A typical module directory is
@file{/usr/local/share/guile/site/2.0/}).  However, Guile does not
search for modules in @file{/usr/local/...}, so most likely you would
want to configure the package using @code{--with-guile-site-dir} and
@code{--with-guile-site-ccache-dir} options, like this:

@example
$ ./configure --with-guile-site-dir=/usr/share/guile/site/2.0 \
              --with-guile-site-ccache-dir=/usr/lib/guile/2.0/site-ccache
@end example

These are the default directories where @file{*.scm} and @file{*.go}
files should go if Guile was installed into @code{/usr}.  Of course,
you can specify any other directories, but make sure to add them to
@code{GUILE_LOAD_PATH} and @code{GUILE_LOAD_COMPILED_PATH} accordingly
(@pxref{Environment Variables,,, guile, The GNU Guile Reference
Manual}).

Alternatively, you can just install Guile-XOSD using the same prefix as was
specified for Guile:

@example
$ ./configure --prefix=/usr
@end example

@node API Reference
@chapter API Reference

This chapter describes Guile procedures provided by Guile-XOSD.
All of them are contained in @code{(xosd)} module.

@menu
* Direct bindings::
* Higher-level wrappers::
@end menu

@node Direct bindings
@section Direct bindings

This section lists Guile procedures that are direct wrappers of the
original C procedures provided by the @code{libxosd} library.  See
@code{xosd.h} coming with @code{libxosd} for details on the C
procedures.

@deffn {Scheme Procedure} create-osd [number-of-lines]
Wrapper for @code{xosd_create}.

Create and return a new OSD object with the specified maximum
@var{number-of-lines} (1 by default) that this object can display
(this value cannot be changed after OSD creation).
@end deffn

@deffn {Scheme Procedure} kill-osd osd
Wrapper for @code{xosd_destroy}.

Destroy @var{osd} object (free up the used memory).
@end deffn

@deffn {Scheme Procedure} display-string-in-osd osd string line-number
Wrapper for @code{xosd_display} called with @code{XOSD_string} enumerator.

Display @var{string} in @var{line-number} of @var{osd} object.
Line numbers are enumerated from zero i.e., @var{line-number} must be
less than the number of lines set during @var{osd} creation.

This procedure returns immediately, but the @var{string} is displayed
until timeout set by @code{set-osd-timeout!} is expired.  If blocking
is required, @code{wait-while-osd-displayed} should be called after
this procedure.
@end deffn

@deffn {Scheme Procedure} display-percentage-in-osd osd percentage line-number
Wrapper for @code{xosd_display} called with @code{XOSD_percentage} enumerator.

Display @var{percentage} in @var{line-number} of @var{osd} object.
@var{percentage} is a number between 0 and 100.  See also
@code{display-string-in-osd}.
@end deffn

@deffn {Scheme Procedure} display-slider-in-osd osd percentage line-number
Wrapper for @code{xosd_display} called with @code{XOSD_slider} enumerator.

Display @var{percentage} in @var{line-number} of @var{osd} object.
@var{percentage} (slider position) is a number between 0 and 100.  See
also @code{display-string-in-osd}.
@end deffn

@deffn {Scheme Procedure} hide-osd osd
Wrapper for @code{xosd_hide}.

Hide @var{osd} object.
@end deffn

@deffn {Scheme Procedure} show-osd osd
Wrapper for @code{xosd_show}.

Show (redisplay) hidden @var{osd} object.
@end deffn

@deffn {Scheme Procedure} osd-displayed? osd
Wrapper for @code{xosd_is_onscreen}.

Return @code{#t} if @var{osd} object is displayed.  Return @code{#f}
otherwise.
@end deffn

@deffn {Scheme Procedure} wait-while-osd-displayed osd
Wrapper for @code{xosd_wait_until_no_display}.

Wait until @var{osd} object will be hidden.  See also
@code{display-string-in-osd}.
@end deffn

@deffn {Scheme Procedure} set-osd-timeout! osd seconds
Wrapper for @code{xosd_set_timeout}.

Change the number of @var{seconds} before @var{osd} object is hidden.
@end deffn

@deffn {Scheme Procedure} set-osd-font! osd font
Wrapper for @code{xosd_set_font}.

Change font of @var{osd} object.  @var{font} is a string with
the XLFD full name of the new font (see @code{xfontsel} program for
details).
@end deffn

@deffn {Scheme Procedure} set-osd-bar-length! osd length
Wrapper for @code{xosd_set_bar_length}.

Change @var{length} of a slider or percentage bar of @var{osd} object.
Setting @var{length} to -1 reverts to the default behavior.
@end deffn

@deffn {Scheme Procedure} set-osd-position! osd position
Wrapper for @code{xosd_set_pos}.

Change vertical @var{position} of @var{osd} object.  @var{position}
should be one of the following symbols: @code{top}, @code{middle}, or
@code{bottom}.
@end deffn

@deffn {Scheme Procedure} set-osd-align! osd align
Wrapper for @code{xosd_set_align}.

Change horizontal alignment of @var{osd} object.  @var{align} should
be one of the following symbols: @code{left}, @code{center}, or
@code{right}.
@end deffn

@deffn {Scheme Procedure} set-osd-vertical-offset! osd offset
Wrapper for @code{xosd_set_vertical_offset}.

Change vertical offset of @var{osd} object.  @var{offset} is a number
of pixels to offset @var{osd} from its default vertical position
(specified by @code{set-osd-position!}).
@end deffn

@deffn {Scheme Procedure} set-osd-horizontal-offset! osd offset
Wrapper for @code{xosd_set_horizontal_offset}.

Change horizontal offset of @var{osd} object.  @var{offset} is a
number of pixels to offset @var{osd} from its default horizontal
position (specified by @code{set-osd-align!}).
@end deffn

@deffn {Scheme Procedure} set-osd-shadow-offset! osd offset
Wrapper for @code{xosd_set_shadow_offset}.

Change @var{offset} (number of pixels) of the text shadow of @var{osd}
object.
@end deffn

@deffn {Scheme Procedure} set-osd-outline-offset! osd offset
Wrapper for @code{xosd_set_outline_offset}.

Change @var{offset} (number of pixels) of the text outline of
@var{osd} object.
@end deffn

@deffn {Scheme Procedure} set-osd-shadow-color! osd color
Wrapper for @code{xosd_set_shadow_colour}.

Change @var{color} of the text shadow of @var{osd} object.
See @code{set-osd-color!} for the meaning of @var{color}.
@end deffn

@deffn {Scheme Procedure} set-osd-outline-color! osd color
Wrapper for @code{xosd_set_outline_colour}.

Change @var{color} of the text outline of @var{osd} object.
See @code{set-osd-color!} for the meaning of @var{color}.
@end deffn

@deffn {Scheme Procedure} set-osd-color! osd color
Wrapper for @code{xosd_set_colour}.

Change @var{color} of @var{osd} object.  @var{color} is a string with
the color value (e.g., @code{#2e8b57}) or the color name (e.g.,
@code{DeepSkyBlue}).
@end deffn

@deffn {Scheme Procedure} xosd-color osd
Wrapper for @code{xosd_get_colour}.

Get RGB value of @var{osd} object's color.  Return a list of 3 numbers
(red, green and blue).  @emph{Note:} the returned values have X11
color format i.e., 16-bit values (0--65535), not 8-bit values
(0--255).
@end deffn

@deffn {Scheme Procedure} osd-number-of-lines osd
Wrapper for @code{xosd_get_number_lines}.

Return the maximum number of lines allowed for @var{osd} object.
@end deffn

@deffn {Scheme Procedure} scroll-osd osd number-of-lines
Wrapper for @code{xosd_scroll}.

Scroll @var{osd} object by @var{number-of-lines}.
@end deffn

@node Higher-level wrappers
@section Higher-level wrappers

Along with the above direct wrappers for @code{libxosd} procedures,
@code{(xosd)} module provides some higher-level interface to deal with
OSD objects.

@deffn {Scheme Procedure} make-osd [#:lines 1] [#:align] [#:position] @
       [#:bar-length] [#:timeout] [#:color] [#:font] @
       [#:horizontal-offset] [#:vertical-offset] [#:outline-offset] @
       [#:shadow-offset] [#:outline-color] [#:shadow-color]

Create and return a new OSD object with the specified parameters.
This procedure calls @code{(create-osd lines)} and then
@code{set-osd!} with the other specified keywords.
@end deffn

@deffn {Scheme Procedure} set-osd! osd [#:align] [#:position] @
       [#:bar-length] [#:timeout] [#:color] [#:font] @
       [#:horizontal-offset] [#:vertical-offset] [#:outline-offset] @
       [#:shadow-offset] [#:outline-color] [#:shadow-color]

Update @var{osd} object with the specified parameters.  This procedure
calls @code{set-osd-@dots{}!} for the respecting keywords.
@end deffn

@deffn {Scheme Procedure} toggle-osd osd
Hide or show @var{osd}.
@end deffn

@node Example
@chapter Example

Now let's look at a simple example of using Guile-XOSD.  The following
piece of code displays ``Hello!'' OSD in the top right corner of your
screen for 3 seconds.

@lisp
@include hello.scm
@end lisp

You can find other examples of using @code{(xosd)} module in
@file{<prefix>/share/guile-xosd/examples} directory.

@node Hacking
@chapter Hacking

It is possible to use Guile-XOSD without installation (after running
@code{./configure} and @code{make} but without @code{make install}).
All is needed is setting the following environment variables:

@table @code
@item GUILE_LOAD_PATH
@itemx GUILE_LOAD_COMPILED_PATH
@xref{Environment Variables,,, guile, GNU Guile Reference Manual}.
@end table

Setting them manually is not needed as Guile-XOSD provides
@file{pre-inst-env} and @file{pre-inst-env.el} files for this purpose.

@itemize @bullet
@item
@file{pre-inst-env} is a shell script that sets the required
environment variables, and runs the specified command.  A typical use
is:

@example
$ ./pre-inst-env guile
scheme@@(guile-user)> ,use(xosd)
...
@end example

@item
If you live in Emacs, you may find @file{pre-inst-env.el} more useful.
If you load this file (for example, with @kbd{M-x load-file}), it will
set the environment inside Emacs, so you can run Guile in @kbd{M-x
shell}, or more importantly, start Geiser and use Guile-XOSD modules
there.

@end itemize

@node GNU Free Documentation License
@appendix GNU Free Documentation License

@include fdl.texi

@bye
